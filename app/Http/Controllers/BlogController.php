<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use Illuminate\Support\Str;

class BlogController extends Controller
{
    /**
     * ブログ記事一覧を表示
     */
    public function index()
    {
        $articles = $this->getAllArticles();
        return view('blog.index', compact('articles'));
    }

    /**
     * 個別記事を表示
     */
    public function show($slug)
    {
        $article = $this->getArticleBySlug($slug);
        
        if (!$article) {
            abort(404);
        }

        // MarkdownをHTMLに変換
        if (!empty($article['content'])) {
            $article['content'] = $this->parseMarkdown($article['content']);
        }

        $relatedArticles = $this->getRelatedArticles($article['category'], $slug);
        
        return view('blog.show', compact('article', 'relatedArticles'));
    }

    /**
     * カテゴリー別記事一覧
     */
    public function category($category)
    {
        $articles = $this->getArticlesByCategory($category);
        $categoryName = $this->getCategoryName($category);
        
        return view('blog.category', compact('articles', 'categoryName', 'category'));
    }

    /**
     * MarkdownをHTMLに変換
     */
    private function parseMarkdown(string $markdown): string
    {
        // 見出し
        $html = preg_replace('/^### (.+)$/m', '<h3>$1</h3>', $markdown);
        $html = preg_replace('/^## (.+)$/m', '<h2>$1</h2>', $html);
        
        // 太字
        $html = preg_replace('/\*\*(.+?)\*\*/', '<strong>$1</strong>', $html);
        
        // リスト
        $html = preg_replace('/^- (.+)$/m', '<li>$1</li>', $html);
        $html = preg_replace('/(<li>.*<\/li>\n?)+/', '<ul>$0</ul>', $html);
        
        // 番号付きリスト
        $html = preg_replace('/^\d+\. (.+)$/m', '<li>$1</li>', $html);
        
        // テーブル（シンプルな変換）
        $html = preg_replace_callback('/\|(.+)\|/m', function($matches) {
            $cells = explode('|', trim($matches[1]));
            $cells = array_map('trim', $cells);
            if (preg_match('/^[-:\s|]+$/', $matches[1])) {
                return ''; // ヘッダー区切り行を削除
            }
            $row = '<tr>';
            foreach ($cells as $cell) {
                $row .= '<td>' . $cell . '</td>';
            }
            $row .= '</tr>';
            return $row;
        }, $html);
        $html = preg_replace('/(<tr>.*<\/tr>\n?)+/', '<table class="markdown-table">$0</table>', $html);
        
        // 段落
        $html = preg_replace('/\n\n/', '</p><p>', $html);
        $html = '<p>' . $html . '</p>';
        
        // 空の要素を削除
        $html = preg_replace('/<p><(h[23]|ul|table)/m', '<$1', $html);
        $html = preg_replace('/<\/(h[23]|ul|table)><\/p>/m', '</$1>', $html);
        $html = preg_replace('/<p>\s*<\/p>/', '', $html);
        
        return $html;
    }

    /**
     * 全記事を取得
     */
    private function getAllArticles(): array
    {
        return [
            [
                'id' => 1,
                'slug' => 'how-to-calculate-loan',
                'title' => '住宅ローンの返済額を計算する方法と注意点',
                'excerpt' => '住宅ローンを組む際に知っておきたい返済額の計算方法と、押さえておくべき重要なポイントを解説します。',
                'content' => $this->getArticleContent('how-to-calculate-loan'),
                'category' => 'money',
                'tags' => ['ローン', '住宅', '返済計算'],
                'published_at' => '2024-12-10',
                'reading_time' => '5分',
            ],
            [
                'id' => 2,
                'slug' => 'savings-compound-interest',
                'title' => '複利効果を活用した賢い貯蓄術',
                'excerpt' => '複利の力を理解して、効率的に資産を増やす方法をわかりやすく解説します。',
                'content' => $this->getArticleContent('savings-compound-interest'),
                'category' => 'money',
                'tags' => ['貯蓄', '複利', '資産運用'],
                'published_at' => '2024-12-08',
                'reading_time' => '6分',
            ],
            [
                'id' => 3,
                'slug' => 'tax-calculation-basics',
                'title' => '消費税の計算方法完全ガイド',
                'excerpt' => '消費税の計算方法、軽減税率の適用、インボイス制度について詳しく解説します。',
                'content' => $this->getArticleContent('tax-calculation-basics'),
                'category' => 'money',
                'tags' => ['税金', '消費税', '軽減税率'],
                'published_at' => '2024-12-05',
                'reading_time' => '7分',
            ],
            [
                'id' => 4,
                'slug' => 'discount-shopping-tips',
                'title' => '割引計算で賢く買い物をするコツ',
                'excerpt' => '割引率の計算方法と、お得な買い物をするための実践的なテクニックを紹介します。',
                'content' => $this->getArticleContent('discount-shopping-tips'),
                'category' => 'money',
                'tags' => ['割引', '買い物', '節約'],
                'published_at' => '2024-12-03',
                'reading_time' => '4分',
            ],
            [
                'id' => 5,
                'slug' => 'split-bill-etiquette',
                'title' => '割り勘の計算とマナー：スマートな支払い方法',
                'excerpt' => '友人や同僚との食事で使える、スマートな割り勘計算とマナーについて解説します。',
                'content' => $this->getArticleContent('split-bill-etiquette'),
                'category' => 'lifestyle',
                'tags' => ['割り勘', '支払い', 'マナー'],
                'published_at' => '2024-12-01',
                'reading_time' => '5分',
            ],
            [
                'id' => 6,
                'slug' => 'age-calculation-japanese-system',
                'title' => '年齢計算と日本の年齢システムについて',
                'excerpt' => '満年齢、数え年、学年の関係など、日本特有の年齢システムについて詳しく解説します。',
                'content' => $this->getArticleContent('age-calculation-japanese-system'),
                'category' => 'date',
                'tags' => ['年齢', '満年齢', '数え年'],
                'published_at' => '2024-11-28',
                'reading_time' => '6分',
            ],
            [
                'id' => 7,
                'slug' => 'school-entrance-calculation',
                'title' => '入学・卒業年の計算方法と学年早見表',
                'excerpt' => '生年月日から入学・卒業年を計算する方法と、覚えておくと便利な学年早見表を紹介します。',
                'content' => $this->getArticleContent('school-entrance-calculation'),
                'category' => 'date',
                'tags' => ['入学', '卒業', '学年'],
                'published_at' => '2024-11-25',
                'reading_time' => '5分',
            ],
            [
                'id' => 8,
                'slug' => 'date-calculation-business',
                'title' => 'ビジネスで役立つ日数計算テクニック',
                'excerpt' => 'プロジェクト管理や契約期間の計算など、ビジネスシーンで使える日数計算の方法を解説します。',
                'content' => $this->getArticleContent('date-calculation-business'),
                'category' => 'date',
                'tags' => ['日数計算', 'ビジネス', 'プロジェクト管理'],
                'published_at' => '2024-11-22',
                'reading_time' => '6分',
            ],
            [
                'id' => 9,
                'slug' => 'interest-rate-comparison',
                'title' => '金利の種類と比較方法：知っておきたい基礎知識',
                'excerpt' => '単利・複利・実質金利など、様々な金利の種類と比較方法について解説します。',
                'content' => $this->getArticleContent('interest-rate-comparison'),
                'category' => 'money',
                'tags' => ['金利', '利息', '比較'],
                'published_at' => '2024-11-20',
                'reading_time' => '7分',
            ],
            [
                'id' => 10,
                'slug' => 'financial-planning-basics',
                'title' => '人生100年時代のライフプラン計算術',
                'excerpt' => '長期的な視点でお金を計画するための、ライフプラン作成の基本を解説します。',
                'content' => $this->getArticleContent('financial-planning-basics'),
                'category' => 'money',
                'tags' => ['ライフプラン', '資金計画', '人生設計'],
                'published_at' => '2024-11-18',
                'reading_time' => '8分',
            ],
            [
                'id' => 11,
                'slug' => 'calculator-tools-comparison',
                'title' => '計算ツールの選び方：用途別おすすめガイド',
                'excerpt' => '日常生活で使える様々な計算ツールの特徴と、目的に応じた選び方を紹介します。',
                'content' => $this->getArticleContent('calculator-tools-comparison'),
                'category' => 'tools',
                'tags' => ['計算ツール', '比較', '使い方'],
                'published_at' => '2024-11-15',
                'reading_time' => '5分',
            ],
            [
                'id' => 12,
                'slug' => 'mobile-calculator-tips',
                'title' => 'スマホで簡単！外出先での計算テクニック',
                'excerpt' => 'スマートフォンを使って、外出先でも素早く正確に計算するためのコツを紹介します。',
                'content' => $this->getArticleContent('mobile-calculator-tips'),
                'category' => 'tools',
                'tags' => ['スマホ', 'モバイル', '便利技'],
                'published_at' => '2024-11-12',
                'reading_time' => '4分',
            ],
            [
                'id' => 13,
                'slug' => 'daily-calculation-habits',
                'title' => '日常で役立つ暗算のコツと習慣',
                'excerpt' => '日々の生活で使える暗算テクニックと、計算力を向上させる習慣について解説します。',
                'content' => $this->getArticleContent('daily-calculation-habits'),
                'category' => 'lifestyle',
                'tags' => ['暗算', '習慣', '計算力'],
                'published_at' => '2024-11-10',
                'reading_time' => '5分',
            ],
            [
                'id' => 14,
                'slug' => 'family-budget-management',
                'title' => '家計簿いらず！簡単家計管理の計算術',
                'excerpt' => '複雑な家計簿をつけなくても、シンプルな計算で家計を管理する方法を紹介します。',
                'content' => $this->getArticleContent('family-budget-management'),
                'category' => 'lifestyle',
                'tags' => ['家計管理', '予算', '節約'],
                'published_at' => '2024-11-08',
                'reading_time' => '6分',
            ],
            [
                'id' => 15,
                'slug' => 'retirement-savings-calculator',
                'title' => '老後資金の計算方法：いくら必要？',
                'excerpt' => '老後に必要な資金を計算し、今から準備すべき金額を把握する方法を解説します。',
                'content' => $this->getArticleContent('retirement-savings-calculator'),
                'category' => 'money',
                'tags' => ['老後資金', '年金', '貯蓄計画'],
                'published_at' => '2024-11-05',
                'reading_time' => '8分',
            ],
        ];
    }

    /**
     * スラッグから記事を取得
     */
    private function getArticleBySlug(string $slug): ?array
    {
        $articles = $this->getAllArticles();
        foreach ($articles as $article) {
            if ($article['slug'] === $slug) {
                return $article;
            }
        }
        return null;
    }

    /**
     * カテゴリー別記事を取得
     */
    private function getArticlesByCategory(string $category): array
    {
        $articles = $this->getAllArticles();
        return array_filter($articles, function($article) use ($category) {
            return $article['category'] === $category;
        });
    }

    /**
     * 関連記事を取得
     */
    private function getRelatedArticles(string $category, string $excludeSlug, int $limit = 3): array
    {
        $articles = $this->getArticlesByCategory($category);
        $filtered = array_filter($articles, function($article) use ($excludeSlug) {
            return $article['slug'] !== $excludeSlug;
        });
        return array_slice($filtered, 0, $limit);
    }

    /**
     * カテゴリー名を取得
     */
    private function getCategoryName(string $category): string
    {
        $categories = [
            'money' => '金融・お金',
            'date' => '日付・時間',
            'lifestyle' => 'ライフスタイル',
            'tools' => 'ツール・使い方',
        ];
        return $categories[$category] ?? $category;
    }

    /**
     * 記事本文を取得
     */
    private function getArticleContent(string $slug): string
    {
        $contents = [
            'how-to-calculate-loan' => <<<'CONTENT'
## 住宅ローン計算の基本

住宅ローンを組む際、毎月の返済額がいくらになるかを事前に把握することは非常に重要です。この記事では、住宅ローンの返済額を計算する方法と、契約前に確認すべきポイントについて詳しく解説します。

## 住宅ローンの返済方式

住宅ローンには主に2つの返済方式があります。

### 元利均等返済
毎月の返済額（元金＋利息）が一定となる返済方式です。返済計画が立てやすく、多くの方がこの方式を選択しています。

**メリット：**
- 毎月の返済額が一定で家計管理がしやすい
- 返済当初の負担が元金均等より軽い

**デメリット：**
- 総返済額は元金均等より多くなる
- 返済当初は利息の割合が大きい

### 元金均等返済
毎月の元金返済額が一定で、利息が徐々に減少していく返済方式です。

**メリット：**
- 総返済額が元利均等より少ない
- 返済が進むにつれ負担が軽くなる

**デメリット：**
- 返済当初の負担が大きい
- 収入に余裕がないと厳しい

## 返済額の計算例

例えば、以下の条件でローンを組んだ場合：
- 借入金額：3,500万円
- 金利：1.5%（固定）
- 返済期間：35年

元利均等返済の場合、毎月の返済額は約107,164円となります。

## 注意すべきポイント

1. **金利タイプの選択**
   - 固定金利：返済期間中ずっと金利が変わらない
   - 変動金利：市場金利に応じて変動する
   - 固定期間選択型：一定期間は固定、その後変動

2. **諸費用を忘れずに**
   - 事務手数料
   - 保証料
   - 団体信用生命保険料
   - 登記費用

3. **返済負担率の確認**
   - 年収に対する年間返済額の割合
   - 一般的に25%以下が望ましい

当サイトのローン計算ツールを使えば、様々な条件でのシミュレーションが可能です。ぜひご活用ください。
CONTENT,

            'savings-compound-interest' => <<<'CONTENT'
## 複利とは何か

複利とは、元金だけでなく、それまでに発生した利息にも利息がつく仕組みのことです。アルバート・アインシュタインが「人類最大の発明」と呼んだとも言われる、資産形成において非常に重要な概念です。

## 単利と複利の違い

### 単利の場合
元金100万円を年利3%で10年間運用すると：
- 毎年の利息：100万円 × 3% = 3万円
- 10年後の合計：100万円 + (3万円 × 10年) = **130万円**

### 複利の場合
同じ条件で複利運用すると：
- 1年目：100万円 × 1.03 = 103万円
- 2年目：103万円 × 1.03 = 106.09万円
- ...
- 10年後：100万円 × (1.03)^10 = **約134.4万円**

たった4万円の差と思うかもしれませんが、期間が長くなるほど、この差は大きくなります。

## 複利効果を最大化する3つのポイント

### 1. できるだけ早く始める
複利効果は時間が味方です。20歳から毎月1万円を積み立てる人と、30歳から始める人では、60歳時点で数百万円の差が生まれます。

### 2. できるだけ長く続ける
途中で解約せず、長期間運用を続けることで複利効果が発揮されます。

### 3. 再投資を徹底する
配当金や利息を受け取らず、再投資に回すことで複利効果を最大化できます。

## 72の法則

資産が2倍になるまでの年数を簡単に計算できる法則です。

**72 ÷ 年利（%）= 資産が2倍になる年数**

例えば、年利3%なら 72 ÷ 3 = 24年で資産が2倍になります。

## 積立投資での活用

毎月コツコツ積み立てる場合も、複利効果は大きな力を発揮します。

- 毎月3万円を年利5%で30年間積み立てた場合
- 元本：3万円 × 12ヶ月 × 30年 = 1,080万円
- 30年後の資産：約2,497万円

約1,400万円が複利効果による利益です。

当サイトの積み立て計算ツールで、あなたの積立プランをシミュレーションしてみましょう。
CONTENT,

            'tax-calculation-basics' => <<<'CONTENT'
## 消費税の基本

消費税は、商品やサービスを購入する際に課される間接税です。2019年10月から標準税率は10%となり、一部の品目には軽減税率8%が適用されています。

## 消費税の計算方法

### 税込価格から税抜価格を求める

**標準税率（10%）の場合：**
税抜価格 = 税込価格 ÷ 1.1

例：税込1,100円の商品
税抜価格 = 1,100 ÷ 1.1 = 1,000円
消費税 = 100円

**軽減税率（8%）の場合：**
税抜価格 = 税込価格 ÷ 1.08

### 税抜価格から税込価格を求める

**標準税率（10%）の場合：**
税込価格 = 税抜価格 × 1.1

**軽減税率（8%）の場合：**
税込価格 = 税抜価格 × 1.08

## 軽減税率の対象品目

8%の軽減税率が適用されるのは：

1. **飲食料品**（酒類・外食を除く）
   - スーパーで買う食品
   - テイクアウト・宅配
   - 有料老人ホームでの食事

2. **定期購読の新聞**
   - 週2回以上発行される新聞

### 軽減税率の判断が難しいケース

- **ファストフード**：店内飲食は10%、テイクアウトは8%
- **コンビニのイートイン**：店内飲食は10%、持ち帰りは8%
- **ケータリング**：10%（単なる配達は8%）

## インボイス制度について

2023年10月から開始されたインボイス制度は、適格請求書（インボイス）の発行・保存が仕入税額控除の要件となる制度です。

**事業者への影響：**
- 適格請求書発行事業者の登録が必要
- 請求書の記載事項が厳格化
- 免税事業者との取引に注意

## 確定申告での消費税

課税売上高が1,000万円を超える事業者は、消費税の申告・納付義務があります。

当サイトの税金計算ツールを使えば、素早く正確に消費税を計算できます。
CONTENT,

            'discount-shopping-tips' => <<<'CONTENT'
## 割引計算の基本

買い物をする際、「30%OFF」「2割引」といった表示を見かけますが、実際にいくら安くなるのか、すぐに計算できますか？この記事では、割引計算の方法と賢い買い物のコツを紹介します。

## 割引率の計算方法

### 基本の計算式

**割引後価格 = 元の価格 ×（1 - 割引率）**

例：10,000円の商品が30%OFF
割引後価格 = 10,000円 ×（1 - 0.3）= 10,000円 × 0.7 = 7,000円

### 簡単な暗算テクニック

- **10%OFF**：元の価格の1割を引く（10,000円→9,000円）
- **20%OFF**：元の価格の2割を引く（10,000円→8,000円）
- **25%OFF**：元の価格の4分の1を引く（10,000円→7,500円）
- **50%OFF**：半額（10,000円→5,000円）

## お得な買い物をするためのコツ

### 1. 割引率より実際の金額で判断

5,000円の商品が10%OFFと、500円引きは同じ500円の割引です。表示方法に惑わされず、実際の割引額で比較しましょう。

### 2. 複数割引の計算に注意

「20%OFF + さらに10%OFF」は30%OFFではありません。

正しい計算：
- まず20%OFF：10,000円 × 0.8 = 8,000円
- さらに10%OFF：8,000円 × 0.9 = 7,200円
- 実質の割引率：28%

### 3. ポイント還元との比較

10%OFFと10%ポイント還元は同じではありません。
- 10%OFF：その場で10%安く買える
- 10%ポイント還元：次回以降使える（使わなければ意味がない）

### 4. まとめ買い割引の計算

「3点買うと1点無料」は実質33%OFF
「2点目半額」は実質25%OFF（2点買った場合）

## 二重価格表示に注意

「通常価格10,000円→特価5,000円」といった表示には注意が必要です。
- 本当にお得なのか、他店と比較する
- 通常価格が適正か確認する

当サイトの割引計算ツールを使えば、複雑な割引計算も一瞬でできます。
CONTENT,

            'split-bill-etiquette' => <<<'CONTENT'
## 割り勘の基本計算

飲み会や食事会での支払い、スムーズにできていますか？この記事では、割り勘計算の方法とスマートな支払いマナーについて解説します。

## 割り勘の計算方法

### 基本の均等割り

**一人あたりの金額 = 合計金額 ÷ 人数**

例：15,000円を4人で割り勘
一人あたり = 15,000 ÷ 4 = 3,750円

### 端数の処理

割り勘で端数が出た場合の対処法：

1. **切り上げ方式**：3,750円→4,000円にして、余りは幹事が管理
2. **切り捨て方式**：3,750円→3,500円にして、不足分は幹事が負担
3. **四捨五入方式**：3,750円→3,800円（100円単位で調整）

### 傾斜をつける割り勘

年齢や立場、飲む量に差がある場合の計算例：

- 上司・先輩：多めに支払う（1.2〜1.5倍）
- 若手・新人：少なめに支払う（0.7〜0.8倍）
- お酒を飲まない人：少なめに設定

例：合計20,000円、上司2人（1.5倍）、若手3人（0.8倍）
- 基準額をXとすると：2×1.5X + 3×0.8X = 20,000
- 3X + 2.4X = 20,000
- X = 3,704円
- 上司：約5,556円、若手：約2,963円

## 割り勘のマナー

### 支払いをスムーズにするコツ

1. **事前に概算を伝える**：「一人5,000円くらいになりそう」
2. **お釣りがないように準備**：千円札を多めに用意
3. **幹事への感謝**：計算・集金してくれた人への配慮を忘れずに

### こんな時どうする？

- **途中参加・途中退出**：滞在時間に応じて調整
- **特別な料理を頼んだ人**：個別会計にするか、その分を上乗せ
- **会費制の場合**：事前に金額を決めて余りは繰り越しor返金

## 割り勘アプリの活用

スマートフォンの割り勘アプリを使えば：
- その場で素早く計算できる
- 傾斜配分も簡単に設定可能
- 支払い履歴を記録できる

当サイトの割り勘計算ツールをぜひご活用ください。
CONTENT,

            'age-calculation-japanese-system' => <<<'CONTENT'
## 日本の年齢システム

日本には「満年齢」と「数え年」という2つの年齢の数え方があります。それぞれの違いと使い分けについて解説します。

## 満年齢とは

現在、日本で公式に使用されている年齢の数え方です。

**計算方法：**
- 生まれた日を0歳とする
- 誕生日を迎えるごとに1歳ずつ加算

**使用される場面：**
- 公的書類（免許証、パスポートなど）
- 学校の入学資格
- 成人年齢の判定
- 年金受給資格

### 年齢計算に関する法律

日本の法律上、年齢は誕生日の前日に1歳加算されます。

例：4月1日生まれの場合
- 3月31日が年齢加算日
- そのため、早生まれ扱いになる

## 数え年とは

伝統的な年齢の数え方で、現在でも一部で使用されています。

**計算方法：**
- 生まれた年を1歳とする
- 元日（1月1日）を迎えるごとに1歳ずつ加算

**使用される場面：**
- 厄年の計算
- 七五三
- 長寿のお祝い（還暦、古希など）
- 神社仏閣での年齢

### 満年齢との差

- 誕生日前：数え年 = 満年齢 + 2
- 誕生日後：数え年 = 満年齢 + 1

## 学年と年齢の関係

日本の学校制度では：

**小学校入学**
- 4月1日時点で満6歳であること
- 4月2日生まれ〜翌年4月1日生まれが同じ学年

**早生まれとは**
- 1月1日〜4月1日生まれの人
- 同学年の中で誕生日が遅い（若い）

### 学年早見表の使い方

生年月日を入力すると、各学校の入学・卒業年が分かります：
- 小学校：6年間
- 中学校：3年間
- 高校：3年間
- 大学：4年間

## 長寿のお祝い

数え年で祝う伝統的な長寿祝い：

| 名称 | 数え年 | 由来 |
|------|--------|------|
| 還暦 | 61歳 | 干支が一巡する |
| 古希 | 70歳 | 「古来稀なり」 |
| 喜寿 | 77歳 | 「喜」の草書体 |
| 傘寿 | 80歳 | 「傘」の略字 |
| 米寿 | 88歳 | 「米」の字 |
| 卒寿 | 90歳 | 「卒」の略字 |
| 白寿 | 99歳 | 百-一=白 |

当サイトの年齢計算ツールで、満年齢や学年を簡単に計算できます。
CONTENT,

            'school-entrance-calculation' => <<<'CONTENT'
## 学年計算の仕組み

日本の学校は4月始まりで、学年は誕生日によって決まります。この記事では、入学・卒業年の計算方法について詳しく解説します。

## 学年の区切り

同じ学年になる生年月日の範囲：
**〇〇年4月2日生まれ 〜 翌年4月1日生まれ**

### なぜ4月2日から？

法律上、年齢は誕生日の前日に加算されます。そのため：
- 4月1日生まれ → 3月31日に年齢が上がる → 早生まれ扱い
- 4月2日生まれ → 4月1日に年齢が上がる → 遅生まれ扱い

## 各学校の入学・卒業年

生年月日から計算する方法を紹介します。

### 小学校（6年間）

**入学年 = 生まれ年 + 7**（4月2日以降生まれ）
**入学年 = 生まれ年 + 6**（4月1日以前生まれ）

例：2018年5月生まれ
- 入学：2025年4月
- 卒業：2031年3月

### 中学校（3年間）

**入学 = 小学校卒業の翌月**

例：2018年5月生まれ
- 入学：2031年4月
- 卒業：2034年3月

### 高等学校（3年間）

例：2018年5月生まれ
- 入学：2034年4月
- 卒業：2037年3月

### 大学（4年間）

例：2018年5月生まれ
- 入学：2037年4月
- 卒業：2041年3月

## 学年早見表の使い方

当サイトの入学卒業年計算ツールでは、生年月日を入力するだけで：
- 各学校の入学・卒業年月
- 現在の学年
- 卒業までの残り期間

が自動計算されます。

## 特殊なケース

### 浪人・留年した場合

- 浪人1年：大学入学が1年遅れる
- 留年1年：卒業が1年遅れる

### 飛び級・早期卒業

一部の制度では：
- 高校2年から大学入学可能（一部の大学）
- 大学3年で大学院入学可能

### 海外の学校との違い

- アメリカ：9月入学が一般的
- イギリス：9月入学
- オーストラリア：1月〜2月入学

海外留学時は学年の読み替えが必要になる場合があります。

## 入学準備のタイミング

入学の1年前から準備を始めるのがおすすめ：
- ランドセル購入：入学の1年〜半年前
- 学用品購入：入学の2〜3ヶ月前
- 入学式準備：入学の1ヶ月前

当サイトの計算ツールで、お子様の入学年を確認してみましょう。
CONTENT,

            'date-calculation-business' => <<<'CONTENT'
## ビジネスでの日数計算

プロジェクト管理、契約期間、納期計算など、ビジネスシーンでは日数計算が頻繁に必要になります。この記事では、実務で役立つ日数計算テクニックを紹介します。

## 基本の日数計算

### 2つの日付の間の日数

**日数 = 終了日 - 開始日**

例：2024年12月1日から2024年12月25日まで
日数 = 25 - 1 = 24日間

※開始日を含むかどうかで1日変わるため、確認が必要です。

### 営業日計算

土日祝日を除いた営業日数を計算する場合：

1. 総日数を計算
2. 土日の数を引く
3. 祝日の数を引く

例：1ヶ月（30日）の営業日数
- 土日：約8〜10日
- 祝日：0〜3日
- 営業日：約17〜22日

## プロジェクト管理での活用

### ガントチャートの作成

各タスクの所要日数を把握し、全体スケジュールを管理：

1. タスクの洗い出し
2. 各タスクの所要日数を見積もり
3. 依存関係の整理
4. 開始日と終了日を計算

### マイルストーンの設定

重要な節目を日数で管理：
- プロジェクト開始から30日：中間報告
- プロジェクト開始から60日：最終確認
- プロジェクト開始から90日：完了

### バッファの計算

予備日数の設定：
- リスクが低い作業：10〜20%のバッファ
- リスクが高い作業：30〜50%のバッファ

## 契約・法務での日数計算

### 契約期間

契約書に記載される期間の計算：
- 「1ヶ月」：暦月で計算（30日or31日）
- 「30日間」：実日数で計算
- 「翌月末まで」：月末日を終了日とする

### 納期・期限

- 「〇日以内」：当日を含むことが多い
- 「〇営業日以内」：土日祝を除く
- 「〇日まで」：当日を含む

### 時効の計算

法的な時効期間の例：
- 売掛金：5年
- 不法行為：3年
- 労働賃金：3年

## 便利な計算テクニック

### 月をまたぐ場合

例：11月15日から12月20日まで
- 11月：15日〜30日 = 16日
- 12月：1日〜20日 = 20日
- 合計：36日

### 年をまたぐ場合

例：2024年12月1日から2025年1月31日まで
- 2024年12月：31日
- 2025年1月：31日
- 合計：62日

当サイトの日数計算ツールを使えば、複雑な日数計算も一瞬でできます。
CONTENT,

            'interest-rate-comparison' => <<<'CONTENT'
## 金利の基礎知識

金利は「お金を借りる（預ける）際のコスト（利益）」を表す重要な指標です。金融商品を選ぶ際に欠かせない金利の種類と比較方法を解説します。

## 金利の種類

### 単利と複利

**単利**
元金に対してのみ利息が計算されます。

計算式：利息 = 元金 × 金利 × 期間

例：100万円を年利2%で3年間運用
利息 = 100万円 × 2% × 3年 = 6万円

**複利**
元金と利息の合計に対して利息が計算されます。

計算式：元利合計 = 元金 ×（1 + 金利）^期間

例：100万円を年利2%で3年間運用
元利合計 = 100万円 ×（1.02）^3 = 約106.12万円
利息 = 約6.12万円

### 固定金利と変動金利

**固定金利**
契約期間中、金利が変わらない
- メリット：返済計画が立てやすい
- デメリット：市場金利が下がっても恩恵を受けられない

**変動金利**
市場金利に応じて定期的に見直される
- メリット：金利低下時に恩恵を受けられる
- デメリット：金利上昇リスクがある

### 年利・月利・日利

- **年利**：1年間あたりの金利（最も一般的）
- **月利**：1ヶ月あたりの金利（年利÷12）
- **日利**：1日あたりの金利（年利÷365）

## 実質金利の重要性

### 名目金利と実質金利

**名目金利**：表示されている金利
**実質金利**：諸費用を含めた実際の負担率

例：ローン金利2%でも、手数料を含めると実質2.5%になることも。

### APR（実質年率）

すべての費用を含めた年間の実質的な金利。
カードローンやキャッシングではAPRの確認が重要です。

## 金利の比較ポイント

### 預金商品の場合

1. **表面金利だけでなく税引き後で比較**
   - 利息には約20%の税金がかかる
   
2. **複利か単利かを確認**
   - 長期運用なら複利が有利

3. **満期までの期間を確認**
   - 中途解約すると金利が下がる場合も

### ローン商品の場合

1. **実質年率（APR）で比較**
2. **保証料・手数料を含めて計算**
3. **繰り上げ返済の条件を確認**

## 金利計算の実例

住宅ローン3,000万円を比較：
- A銀行：金利1.2%、手数料20万円
- B銀行：金利1.0%、手数料50万円

35年返済で計算すると、総支払額はほぼ同じになることも。

当サイトの利息計算ツールで、様々な条件でシミュレーションしてみましょう。
CONTENT,

            'financial-planning-basics' => <<<'CONTENT'
## ライフプランとは

ライフプランとは、結婚、出産、住宅購入、子どもの教育、退職など、人生の様々なイベントに必要なお金を計画的に準備するための設計図です。

## 人生の三大支出

### 1. 教育資金

子ども1人あたりの教育費目安：
- すべて公立：約1,000万円
- すべて私立：約2,500万円

**準備期間**：子どもが生まれてから大学入学まで約18年

### 2. 住宅資金

住宅購入の平均費用：
- 新築マンション：約4,500万円
- 新築一戸建て：約3,500万円

**準備期間**：頭金（物件価格の10〜20%）を目標に

### 3. 老後資金

老後に必要な資金：
- 夫婦2人で月約22万円（年金含む）
- 不足分：月5〜10万円 × 20〜30年 = 1,200〜3,600万円

## ライフプラン表の作り方

### ステップ1：人生イベントを洗い出す

年齢ごとに予想されるイベントを書き出します：
- 30歳：結婚
- 32歳：第一子誕生
- 35歳：住宅購入
- 50歳：子どもの大学進学
- 65歳：退職

### ステップ2：必要金額を試算

各イベントに必要な金額を見積もります：
- 結婚費用：約350万円
- 出産費用：約50万円（自己負担分）
- 住宅頭金：約500万円
- 大学費用：約500万円
- 老後資金：約2,000万円

### ステップ3：収支を計算

年間の収入と支出を計算し、貯蓄可能額を把握します：
- 収入：給与、ボーナス、副業など
- 支出：生活費、保険料、ローン返済など
- 貯蓄可能額：収入 - 支出

### ステップ4：運用計画を立てる

目標達成のための運用方法を検討：
- 銀行預金（安全性重視）
- 投資信託（リスクを取って増やす）
- 保険（保障と貯蓄の両立）

## 年代別の優先事項

### 20代
- 緊急予備資金の確保（生活費3〜6ヶ月分）
- 少額でも投資を始める
- 奨学金返済の計画

### 30代
- 住宅購入の検討
- 子どもの教育資金準備開始
- 保険の見直し

### 40代
- 教育費のピークに備える
- 老後資金の本格的な準備
- 住宅ローンの繰り上げ返済検討

### 50代
- 老後資金の最終調整
- 退職後の生活設計
- 資産の安全運用へシフト

当サイトの各種計算ツールを活用して、あなたのライフプランを作成してみましょう。
CONTENT,

            'calculator-tools-comparison' => <<<'CONTENT'
## 計算ツールの種類

日常生活やビジネスで使える計算ツールには様々な種類があります。目的に応じた最適なツール選びをご紹介します。

## 金融・お金関連ツール

### ローン計算ツール

**用途**：
- 住宅ローンの返済額シミュレーション
- 自動車ローンの比較検討
- 借り換えのメリット計算

**確認できること**：
- 毎月の返済額
- 総返済額
- 利息の総額

### 積立計算ツール

**用途**：
- 貯蓄目標の達成計画
- 投資信託の積立シミュレーション
- 教育資金・老後資金の計画

**確認できること**：
- 将来の積立総額
- 複利効果による利益
- 目標達成までの期間

### 利息計算ツール

**用途**：
- 預金の利息計算
- 借入金の利息把握
- 投資のリターン計算

### 税金計算ツール

**用途**：
- 消費税の計算
- 税込・税抜価格の変換
- 軽減税率の適用判断

### 割引計算ツール

**用途**：
- セール価格の計算
- 複数割引の適用
- お得度の比較

## 日付・時間関連ツール

### 年齢計算ツール

**用途**：
- 満年齢の確認
- 数え年の計算
- 厄年・長寿祝いの確認

### 入学卒業年計算ツール

**用途**：
- 学年の確認
- 入学・卒業年の計算
- 受験スケジュールの確認

### 日数計算ツール

**用途**：
- 期間の計算
- 記念日までのカウントダウン
- プロジェクト期間の管理

## ツール選びのポイント

### 1. 精度

- 金融計算：小数点以下の精度が重要
- 日付計算：うるう年対応が必要

### 2. 使いやすさ

- 入力項目がシンプル
- 結果がわかりやすい
- スマートフォン対応

### 3. 信頼性

- 計算式が正確
- 税率などが最新
- 運営者情報が明確

## Daily Calc Assistantの特徴

当サイトの計算ツールは：
- **無料で利用可能**：会員登録不要
- **スマートフォン対応**：外出先でも使える
- **シンプルな操作**：誰でも簡単に使える
- **正確な計算**：最新の税率・制度に対応

ぜひ様々な計算ツールをお試しください。
CONTENT,

            'mobile-calculator-tips' => <<<'CONTENT'
## スマートフォンでの計算活用

買い物中の割引計算、外出先での割り勘、急な見積もり計算など、スマートフォンで素早く計算できると便利ですよね。この記事では、モバイルでの計算テクニックを紹介します。

## 外出先で使える計算シーン

### ショッピング時

**活用例1：割引計算**
「30%OFFセール」で元値5,980円の商品
→ 実際にいくらになる？

計算：5,980 × 0.7 = 4,186円

**活用例2：単価比較**
- 500ml 128円
- 1.5L 298円

→ どちらがお得？

計算：
- 500ml：128 ÷ 500 = 0.256円/ml
- 1.5L：298 ÷ 1500 = 0.199円/ml

1.5Lの方がお得！

### 飲食時

**活用例3：割り勘計算**
5人で食事、合計12,340円
→ 一人いくら？

計算：12,340 ÷ 5 = 2,468円
（端数調整で2,500円ずつがスマート）

**活用例4：チップ計算（海外）**
食事代$45でチップ15%
→ チップはいくら？

計算：45 × 0.15 = $6.75

### 移動時

**活用例5：ガソリン代計算**
距離300km、燃費15km/L、ガソリン160円/L
→ 往復のガソリン代は？

計算：(300 × 2) ÷ 15 × 160 = 6,400円

## スマホ計算のコツ

### 1. ブラウザをホーム画面に追加

よく使う計算ツールのページをホーム画面に追加すると、アプリのようにすぐアクセスできます。

**追加方法：**
- iPhone：共有ボタン → 「ホーム画面に追加」
- Android：メニュー → 「ホーム画面に追加」

### 2. 計算結果のスクリーンショット

計算結果を画像で保存しておけば、後で確認できます。比較検討する際にも便利。

### 3. 計算履歴の活用

同じような計算を繰り返す場合、履歴機能があるツールを活用しましょう。

## よくある計算パターン

### 消費税込み→税抜き

税込1,100円を税抜きに：
1,100 ÷ 1.1 = 1,000円

### 税抜き→消費税込み

税抜き1,000円を税込みに：
1,000 × 1.1 = 1,100円

### ％の計算

8,000円の25%：
8,000 × 0.25 = 2,000円

### 何％かを求める

3,000円は12,000円の何％？
3,000 ÷ 12,000 × 100 = 25%

## Daily Calc Assistantの活用

当サイトはスマートフォンに最適化されています：
- タップしやすいボタン
- 見やすい結果表示
- オフラインでも利用可能（一度読み込めば）

ぜひ外出先でもご活用ください。
CONTENT,

            'daily-calculation-habits' => <<<'CONTENT'
## 計算力を上げる習慣

日々の生活の中で使える暗算テクニックと、計算力を向上させる習慣について解説します。ちょっとしたコツで、計算がグッと楽になります。

## 暗算の基本テクニック

### 10を作る計算

**足し算**
7 + 8 = 7 + 3 + 5 = 10 + 5 = 15

8を3と5に分解し、7と3で10を作ります。

**掛け算**
25 × 4 = 100

25と4の組み合わせは100になることを覚えておくと便利。

### 近い数から計算

**例：98 × 6**
= (100 - 2) × 6
= 600 - 12
= 588

98を100-2として計算すると楽です。

### 分解して計算

**例：15 × 12**
= 15 × 10 + 15 × 2
= 150 + 30
= 180

または
= 15 × 4 × 3
= 60 × 3
= 180

## よく使う暗算パターン

### 消費税計算

**10%を足す（×1.1）**
1,000円 → 1,100円
5,500円 → 6,050円

**8%を足す（×1.08）**
1,000円 → 1,080円

コツ：10%を計算してから、2%分を引く
1,000円の10% = 100円
1,000円の2% = 20円
1,000円の8% = 80円
税込 = 1,080円

### 割引計算

**10%OFF**：元の価格から1割引く
10,000円 → 9,000円

**25%OFF**：4分の1を引く
10,000円 → 7,500円

**30%OFF**：10%の3倍を引く
10,000円の10% = 1,000円
10,000円の30% = 3,000円
30%OFF = 7,000円

### 割り算の近似

**÷3**：3分の1
900 ÷ 3 = 300

**÷7**：約14%
700 ÷ 7 = 100
1,000 ÷ 7 ≒ 143

## 計算力を上げる習慣

### 1. 買い物で暗算練習

スーパーでカゴに入れながら合計を暗算。レジで答え合わせ。

### 2. 時計で引き算

「あと何分」「何時間経った」を頭で計算。

### 3. 数字を見たら因数分解

電話番号や車のナンバーを見たら、因数分解してみる。
1234 = 2 × 617

### 4. 毎日の計算タイム

1日5分、計算問題を解く習慣をつける。

## 計算ミスを防ぐコツ

1. **桁を意識する**
   計算前に「大体いくらになるか」を予測

2. **検算する**
   逆の計算で確認（掛け算なら割り算で）

3. **単位を確認**
   円、%、個など単位を間違えないように

計算ツールを使う場合も、暗算で概算してから使うと入力ミスに気づけます。

Daily Calc Assistantで練習しながら、計算力を磨きましょう。
CONTENT,

            'family-budget-management' => <<<'CONTENT'
## シンプル家計管理術

「家計簿が続かない」「記録が面倒」という方のために、シンプルな計算だけで家計を管理する方法をご紹介します。

## 家計管理の基本公式

**貯蓄 = 収入 - 支出**

これが家計管理のすべてです。まずはこの3つの数字を把握しましょう。

## ステップ1：収入を把握

毎月の手取り収入を確認します。

**計算例：**
- 給与手取り：250,000円
- 副業収入：30,000円
- 合計収入：280,000円

## ステップ2：先取り貯蓄を決める

収入の20%を目標に、先に貯蓄額を決めます。

**計算：**
280,000円 × 20% = 56,000円

→ 給料日に自動で別口座へ移動

## ステップ3：固定費を把握

毎月決まって出ていくお金を計算します。

**固定費の例：**
- 家賃・住宅ローン：80,000円
- 保険料：15,000円
- 通信費：10,000円
- サブスク：3,000円
- 固定費合計：108,000円

## ステップ4：変動費の予算を決める

残ったお金が変動費の予算です。

**計算：**
収入280,000円 - 貯蓄56,000円 - 固定費108,000円 = 116,000円

これを週単位で管理：
116,000円 ÷ 4週 = 約29,000円/週

## 週予算管理法

1週間の予算を決めて、その範囲で生活します。

**メリット：**
- 毎日の記録が不要
- 週末に残額を確認するだけ
- 使いすぎても翌週でリカバリー可能

**実践方法：**
1. 週の始めに29,000円を財布（または決済アプリ）に入れる
2. 1週間その範囲で生活
3. 余ったら貯蓄にまわすか、翌週に繰り越し

## 支出の黄金比率

理想的な支出の割合（手取り収入に対して）：

| 項目 | 割合 | 金額例（手取り28万円） |
|------|------|----------------------|
| 住居費 | 25-30% | 70,000-84,000円 |
| 食費 | 15-20% | 42,000-56,000円 |
| 光熱費 | 5-7% | 14,000-19,600円 |
| 通信費 | 3-5% | 8,400-14,000円 |
| 保険 | 5-7% | 14,000-19,600円 |
| 娯楽 | 5-10% | 14,000-28,000円 |
| 貯蓄 | 20% | 56,000円 |

## 年間特別費の計算

毎月ではないけれど必要な出費を年間で計算し、月割りで積み立てます。

**年間特別費の例：**
- 固定資産税：100,000円
- 自動車税：40,000円
- 車検：100,000円（2年に1回）
- 帰省費用：60,000円
- 合計：約300,000円/年

月積立：300,000円 ÷ 12 = 25,000円

## 家計の健康チェック

毎月確認する3つの数字：
1. **貯蓄できた金額**：目標を達成できたか
2. **クレジットカード請求額**：想定内か
3. **口座残高**：前月より増えているか

当サイトの計算ツールを活用して、シンプルな家計管理を始めましょう。
CONTENT,

            'retirement-savings-calculator' => <<<'CONTENT'
## 老後資金はいくら必要？

「老後2000万円問題」が話題になりましたが、実際にいくら必要なのか、どう計算すればいいのか解説します。

## 老後の生活費を計算

### 平均的な老後の支出

総務省の家計調査によると、65歳以上の夫婦世帯の平均支出：
- 月間支出：約27万円
- 年間支出：約324万円

**主な内訳：**
- 食費：約6.5万円
- 住居費：約1.5万円（持ち家の場合）
- 光熱・水道：約2万円
- 医療費：約1.5万円
- 交通・通信：約3万円
- 教養娯楽：約2.5万円
- その他：約10万円

### 年金収入の目安

**厚生年金加入の場合（夫婦世帯）：**
- 平均的な受給額：月約22万円
- 年間：約264万円

**国民年金のみ（夫婦世帯）：**
- 満額受給：月約13万円
- 年間：約156万円

## 不足額の計算

**毎月の不足額 = 支出 - 年金収入**

例：支出27万円 - 年金22万円 = 5万円/月

**老後期間（65歳〜90歳の場合）：**
5万円 × 12ヶ月 × 25年 = **1,500万円**

これに予備費を加えると、約2,000万円という数字になります。

## 老後資金の計算式

**必要老後資金 = (月間支出 - 月間年金) × 12 × 老後年数 + 予備費**

### 計算例

**条件：**
- 希望する生活費：月30万円
- 予想年金額：月20万円
- 老後期間：65歳〜95歳（30年）
- 予備費：500万円

**計算：**
(30万円 - 20万円) × 12 × 30年 + 500万円
= 10万円 × 360ヶ月 + 500万円
= 3,600万円 + 500万円
= **4,100万円**

## 今からいくら貯める？

### 必要な月間積立額の計算

**条件：**
- 目標金額：2,000万円
- 現在の年齢：35歳
- 退職年齢：65歳
- 積立期間：30年
- 想定利回り：3%

**複利運用の場合：**
月々の積立額 ≒ 約34,300円

**普通預金の場合（利回り0%）：**
2,000万円 ÷ 30年 ÷ 12ヶ月 = 約55,600円

複利効果で月々約2万円の差が出ます。

## 老後資金を増やす方法

### 1. iDeCo（個人型確定拠出年金）

- 掛金が全額所得控除
- 運用益が非課税
- 60歳まで引き出せない（強制貯蓄効果）

### 2. つみたてNISA/新NISA

- 運用益が非課税
- いつでも引き出し可能
- 長期・分散投資に最適

### 3. 退職金の活用

- 勤続年数に応じて増加
- 税制優遇あり

## 定期的な見直しを

老後資金計画は、ライフステージに応じて見直しが必要です：
- 30代：将来設計を始める
- 40代：具体的な目標額を設定
- 50代：達成状況を確認、調整
- 60代：運用方法を安全資産へシフト

当サイトの積立計算ツールで、あなたの老後資金計画をシミュレーションしてみましょう。
CONTENT,
        ];

        return $contents[$slug] ?? '';
    }
}
